\documentclass{standalone}
\usepackage{pgfplots}
\pgfplotsset{compat=1.17}
\input{../../symbols}
\input{../../colors}


\begin{document}

\begin{tikzpicture}[baseline=(current bounding box.center), scale=0.85]

  \pgfmathsetseed{1}

  % Define custom colors
  \definecolor{blue}{RGB}{66, 117, 176}
  \definecolor{red}{RGB}{174, 60, 60}
  % Number of points
  \pgfmathsetmacro{\N}{100}
  % Ellipses
  \draw[opacity=0.3, blue, fill=blue, rotate around={45:(-2,-2)}] (-2,-2) ellipse (1.9 and 0.9);
  \draw[opacity=0.3, blue, fill=blue, rotate around={45:(-2,-2)}] (-2,-2) ellipse (1.4 and 0.6);
  \draw[opacity=0.3, blue, fill=blue, rotate around={45:(-2,-2)}] (-2,-2) ellipse (1 and 0.3);
  % Plot area
  \draw[very thick, line cap=round, rounded corners=4pt] (-4, -4) rectangle (0, 0);
  % Axis labels
  \node[below] at (-2, -4) {$z_1$};
  \node[left] at (-4, -2) {$z_2$};
  % Rectangular box
  \draw[very thick, red] (-3.6, -3.6) rectangle (-0.4, -0.4);
  % Random points
  \foreach \i in {1,...,\N} {
    \pgfmathsetmacro{\x}{-3.5 + rnd * 3.}
    \pgfmathsetmacro{\y}{-3.5 + rnd * 3.}
    \fill[red, opacity=0.8] (\x, \y) circle (1.5pt);
  }
  % Plot area
  \draw[very thick, line cap=round, rounded corners=4pt] (1, -4) rectangle (5, 0);
  % Axis labels
  \node[below] at (3, -4) {$z_1$};
  \node[left] at (1, -2) {$z_2$};
   % Ellipses
  \draw[opacity=0.3, blue, fill=blue, rotate around={45:(3,-2)}] (3,-2) ellipse (1.9 and 0.9);
  \draw[opacity=0.3, blue, fill=blue, rotate around={45:(3,-2)}] (3,-2) ellipse (1.4 and 0.6);
  \draw[opacity=0.3, blue, fill=blue, rotate around={45:(3,-2)}] (3,-2) ellipse (1 and 0.3);
  % Contour
  \draw[very thick, red, rotate around={45:(3,-2)}] (3,-2) ellipse (2.1 and 1.1);
    \pgfmathsetmacro\x{2.93} 
    \pgfmathsetmacro\y{-1.31}
    \fill[red, opacity=0.8, rotate around={45:(3,-2)}] (\x,\y) circle (1.5pt);

    \pgfmathsetmacro\newx{3.067} 
    \pgfmathsetmacro\newy{-2.007}
    \pgfmathsetmacro\m{-0.65}
    \fill[red, opacity=0.8, rotate around={45:(3,-2)}] (\newx,\newy) circle (1.5pt);
    \draw[red, thick, opacity=0.7, rotate around={45:(3,-2)}] (\x-0.075,\y+0.4) -- (\newx+0.22,\newy-1.1);
    \draw[red, thick, opacity=0.7, dotted, rotate around={45:(3,-2)}] (\x-0.18,\y+1) -- (\x-0.075,\y+0.4);
    \draw[red, thick, opacity=0.7, dotted, rotate around={45:(3,-2)}] (\newx+0.22,\newy-1.1) -- (\newx+0.34,\newy-1.7);
    \xdef\x{\newx}
    \xdef\y{\newy}

    \pgfmathsetmacro\newx{1.98} 
    \pgfmathsetmacro\newy{-1.80}
    \fill[red, opacity=0.8, rotate around={45:(3,-2)}] (\newx,\newy) circle (1.5pt);
    \draw[red, thick, opacity=0.7, rotate around={45:(3,-2)}] (\x+1.9,\y-0.37) -- (\newx-0.95,\newy+0.18);
    \draw[red, thick, opacity=0.7, dotted, rotate around={45:(3,-2)}] (\x+1.9,\y-0.37) -- (\x+2.2,\y-0.43);
    \draw[red, thick, opacity=0.7, dotted, rotate around={45:(3,-2)}] (\newx-0.95,\newy+0.18) -- (\newx-1.3,\newy+0.24);
    \xdef\x{\newx}
    \xdef\y{\newy}

    \pgfmathsetmacro\newx{3.4} 
    \pgfmathsetmacro\newy{-1.9}
    \fill[red, opacity=0.8, rotate around={45:(3,-2)}] (\newx,\newy) circle (1.5pt);
    \draw[red, thick, opacity=0.7, rotate around={45:(3,-2)}] (\x-1.,\y+0.07) -- (\newx+1.7,\newy-0.12);
    \draw[red, thick, opacity=0.7, dotted, rotate around={45:(3,-2)}] (\x-1.,\y+0.07) -- (\x-1.35,\y+0.09);
    \draw[red, thick, opacity=0.7, dotted, rotate around={45:(3,-2)}] (\newx+1.7,\newy-0.12) -- (\newx+2.1,\newy-0.14);
    \xdef\x{\newx}
    \xdef\y{\newy}

    \pgfmathsetmacro\newx{4.14} 
    \pgfmathsetmacro\newy{-1.4}
    \fill[red, opacity=0.8, rotate around={45:(3,-2)}] (\newx,\newy) circle (1.5pt);
    \draw[red, thick, opacity=0.7, rotate around={45:(3,-2)}] (\x-1.517,\y-1.05) -- (\newx+0.3,\newy+0.2);
    \draw[red, thick, opacity=0.7, dotted, rotate around={45:(3,-2)}] (\x-1.517,\y-1.05) -- (\x-1.8,\y-1.25);
    \draw[red, thick, opacity=0.7, dotted, rotate around={45:(3,-2)}] (\newx+0.3,\newy+0.2) -- (\newx+0.6,\newy+0.45);
    \xdef\x{\newx}
    \xdef\y{\newy}
    
    \pgfmathsetmacro\newx{1.47} 
    \pgfmathsetmacro\newy{-1.61}
    \fill[red, opacity=0.8, rotate around={45:(3,-2)}] (\newx,\newy) circle (1.5pt);
    \draw[red, thick, opacity=0.7, rotate around={45:(3,-2)}] (\x+0.55,\y+0.04) -- (\newx-0.5,\newy-0.02);
    \draw[red, thick, opacity=0.7, dotted, rotate around={45:(3,-2)}] (\x+0.55,\y+0.04) -- (\x+1,\y+0.09);
    \draw[red, thick, opacity=0.7, dotted, rotate around={45:(3,-2)}] (\newx-0.5,\newy-0.02) -- (\newx-0.8,\newy-0.03);
    \xdef\x{\newx}
    \xdef\y{\newy}

    \pgfmathsetmacro\newx{1.628}
    \pgfmathsetmacro\newy{-2.43}
    \fill[red, opacity=0.8, rotate around={45:(3,-2)}] (\newx,\newy) circle (1.5pt);
    \draw[red, thick, opacity=0.7, rotate around={45:(3,-2)}] (\x-0.07,\y+0.3) -- (\newx+0.1,\newy-0.45);
    \draw[red, thick, opacity=0.7, dotted, rotate around={45:(3,-2)}] (\x-0.07,\y+0.3) -- (\x-0.16,\y+0.7);
    \draw[red, thick, opacity=0.7, dotted, rotate around={45:(3,-2)}] (\newx+0.1,\newy-0.45) -- (\newx+0.2,\newy-0.9);
    \xdef\x{\newx}
    \xdef\y{\newy}

\end{tikzpicture}

\end{document}
